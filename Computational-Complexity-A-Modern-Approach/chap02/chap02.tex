\documentclass[a4paper]{article}

\usepackage{amsmath,amsfonts,amssymb}
\usepackage{mathrsfs}
\usepackage{bm}
\usepackage{geometry}
\usepackage{ntheorem}
\usepackage{hyperref}
\usepackage{caption,subcaption}

\geometry{left=2cm,right=2cm,top=2cm,bottom=2cm}

\def\UrlBreaks{\do\A\do\B\do\C\do\D\do\E\do\F\do\G\do\H\do\I\do\J\do\K\do\L\do\M\do\N\do\O\do\P\do\Q\do\R\do\S\do\T\do\U\do\V\do\W\do\X\do\Y\do\Z\do\[\do\\\do\]\do\^\do\_\do\`\do\a\do\b\do\c\do\d\do\e\do\f\do\g\do\h\do\i\do\j\do\k\do\l\do\m\do\n\do\o\do\p\do\q\do\r\do\s\do\t\do\u\do\v\do\w\do\x\do\y\do\z\do\0\do\1\do\2\do\3\do\4\do\5\do\6\do\7\do\8\do\9\do\.\do\@\do\\\do\/\do\!\do\_\do\|\do\;\do\>\do\]\do\)\do\,\do\?\do\'\do+\do\=\do\#}

\newtheorem{theorem}{Theorem}
\newtheorem{lemma}{Lemma}
\newtheorem{proposition}{Proposition}
\newtheorem{corollary}{Corollary}
\newtheorem{claim}{Claim}
\newtheorem{conjecture}{conjecture}
\newtheorem{definition}{Definition}
\newtheorem{construction}{Construction}
\newtheorem*{proof}{Proof}
\newtheorem*{answer}{Answer}
\newtheorem*{refute}{Refute}
\newtheorem*{example}{Example}
\newtheorem*{counterexample}{Counterexample}

\newenvironment{exercise}[1]{
	\par
	\noindent\textbf{Exercise #1.}\quad
}{
	\par
	\bigskip
}


\DeclareMathAccent{\widehat}{\mathord}{largesymbols}{"62}
\newcommand{\abs}[1]{\left| #1 \right|}
\newcommand{\pbra}[1]{\left( #1 \right)}
\newcommand{\cbra}[1]{\left\{ #1 \right\}}
\newcommand{\sbra}[1]{\left[ #1 \right]}
\newcommand{\bin}{\{0,1\}}

\title{Exercise Set --- Chapter $2$}
\date{}

\begin{document}

\maketitle

	\begin{exercise}{2.1}
	    hhh
	\end{exercise}

	\begin{exercise}{2.2}
		\textbf{Solution.}
		\begin{itemize}
			\item 2COL is in NP.

			Given a colouring scheme $C$ for graph $G(V,E)$, where $|V| = n, |E| = m$, we can verify whether $C$ in $O(m)$ time by checking each of edges $e = (u,v)$ whether their color are the same, if there exists $u,v$ whose color is the same, then the colouring scheme $C$ is illegal, otherwise accept $C$.

			2COL is the same as bipartite problem. To find whether a graph can be 2COL. That is, we need only prove there are not exists odd cycle in graph G.
			\item 3COL is in NP. The verify method is the same as 2COL problem.
			\item Connectivity is in NP. 
			Given a graph G, we can decide whether which is connected by a nondeterministic Turing machine in $O(n)$ time.
			\begin{itemize}
				\item Random select a vertex $u\in G(V,E)$, if degree$(u) = 0$, reject. Otherwise:
				\item Let $S = \{u\}$, do:
				%\item \quad Add $u$ to vertex set $S$.
				\item \quad Nondeterministic goto all of neighbour of $u$, and add all of its neighbour to $S$, for any neighbour of $u$, recursively and nondeterministic execute step 3 until for two adjacent step $|S|$ is fixed. 
				\item If $|S| = n$, accept, otherwise reject. 
			\end{itemize}
			The process can be executed at most with depth $n$, and thus the time if $O(n)$ to check whether $G$ is connected by a nondeterministic Turing machine.
		\end{itemize}

		\begin{itemize}
			\item 2COL is in P. %A graph can be 2COL iff it has no odd cycle. 
			\begin{itemize}
				\item For every connected sub-graph of $G$, random select a vertex $v\in V$, color $v$ to red, let step$(v) = 0$, push $v$ into queue $Q$\;
				\item \quad Pop $v$ from $Q$, for any $u \in N(v)$, if $v$ has been coloured, and step$(u)=$ step$(v)$, then reject. If $v$ has not been coloured, do:
				\item \quad \quad Push $u$ to $Q$, step$(u)=step(v) + 1$ (mod $2$);
				\item \quad \quad If step$(u)=0$, color $u$ to red, otherwise color $u$ to blue.
				\item \quad go to step (2) until $Q$ is empty.
			\end{itemize}
			Time complexity: $O(m)$.
			\item Connectivity is in P.
			\begin{itemize}
				\item Random select a vertex $v\in P$, if degree($v$) = 0, reject. Otherwise add $S = \{v\}$.
				\item Using depth first method adding all of neighbours of $u$ into $S$.
				\item Execute step 2 until $|S| = n$ or $|S|$ fixed.
				\item If $|S|< n$ reject, otherwise accept.
			\end{itemize}
			Time complexity: $O(m)$.
		\end{itemize}
	\end{exercise}

	\begin{exercise}{2.3}
	    LINEQ can be solved with Gaussian elimination method, which is in P.
	\end{exercise}

	\begin{exercise}{2.4}
		The problem linear programming is corresponding to the following language:
		\[
			\mathsf{LP} := \{\langle A,b \rangle \mid A \in \mathbb{R}^{m\times n}, b \in \mathbb{R}^m, \exists v \in \mathbb{R}^n: Av \leq b\}.
		\]
		Consider the following polynomial-time algorithm $M$: Given a pair $\langle A,b \rangle$ and a string $u \in \{0,1\}^*$, output $1$ if and only if $u$ encodes a non-empty subset $S \subseteq [m]$ such that for all $v$ in the affine subspace
		\[
			V = \{v \in \mathbb{R}^n \mid \forall i \in S: A_i v = b_i\},
		\]
		$Av \leq b$ holds. We claim it can be verify in polynomial time. By Gauss algorithm, the basis $\{v_1,\ldots,v_k\}$ and bias $b'$ of $V$ can be computed. It just need to be checked that for all $i\in [k]$, $A v_i = 0$ and $Ab' \leq b$. Clearly, $\langle A,b \rangle$ is in $\mathsf{LP}$ if and only if there exists a string $u$ such that $M(\langle A,b \rangle, u) = 1$. Note that a subset of $[m]$, as the certificate, can be encoded with $m$ bits. Thus, $\mathsf{LP}$ is in $\mathbf{NP}$
	\end{exercise}

	\begin{exercise}{2.9}
		To show that the relation $\leq_p$ is not symmetric, we let $L=\{0,1\}^*$ and $L'=SAT$. It is easy to show that $L\leq_p L'$ by transform every $x\in L$ to a tautology such as $x\vee \neq x$. However, $L'\not\leq_p L$ iff we can solve $SAT$ in polynomial time.
	\end{exercise}
	
    \begin{exercise}{2.13}
	\begin{itemize}
\item [(a)]
Parsimonious (Page 50, 2.3.6): 
%The size of certificate of $x$ and certificate of $f(x)$ is the same. $u$ is a certificate for $x$ if $x\in L$ and $u\in \{0,1\}^{p(x)}$ satisfy $M(x,u) = 1$, for some polynomial $p$ and polynomial Turing machine $M$.\\
%where $v = g(u)$ satisfy the above two relationships.
To make the number of solutions for a instance in $L$ is the same as its corresponding SAT instance, we just need to modify the Turing machine $M$ so that it clears up its work tape before outputting a 1 and moves both heads to one end of the tape. Then the final snapshot and head locations are unique. 
\item[(b)]Show a parsimonious reduction from SAT to 3SAT.\\
For a SAT instance $\phi$, which has $n$ variables $x_{1}, \cdots, x_{n}$, $m$ clauses $c_{1},\cdots, c_{m}$, and the maximal size of clause is $k$. We construct a 3SAT instance $\phi'$, which has at most $n + k^{2}$ variables $x_{1},\cdots, x_{n}$ and $y_{1},\cdots , y_{s}$, where $s\leq k^{2}$.

Firstly, for a clause $c_{j} = v_{1} \vee v_{2} \vee \cdots \vee v_{k}$, which equals to 
\begin{equation}(v_{1} \vee v_{2} \vee y_{1} )\wedge (\bar{y}_{1} \vee v_{3} \vee y_{2})
\wedge \cdots \wedge(\bar{y}_{k-1}\vee v_{k - 1} \vee v_{k})
\label{EqSAT}\end{equation}

Execute this partition process for every clauses, this gives $\phi'$. There will be at most  $n + k(k - 1)$ variables and at most $m + k(k - 1)$ clauses. Obviously, the process of the reduction is polynomial time.

To make the reduction parsimonious, we revise the reduction a little.
Change Eq. \ref{EqSAT} to
\begin{equation}
(F \vee v_{1} \vee y_{1} )\wedge (\bar{y}_{1} \vee v_{2} \vee y_{2})\vee \cdots \vee
\wedge (\bar{y}_{k}\vee v_{k} \vee F) \wedge (\bar{v}_{1} \vee \bar{y}_{1} \vee F) \wedge ( y_{1} \vee \bar{y}_{2}\vee F) \cdots \wedge (\bar{v}_{k-1} \vee \bar{y}_{k} \vee F)\wedge 
(  \bar{v}_{k}\vee \bar{y}_{k}\vee F)
\label{EqSAT1}\end{equation}
Thus $\phi'$ has at most $m(3k - 2)$ clauses and $n + k^{2}$ variables.

Now we prove the number of solutions for $\phi$ is the same as solutions for $\phi'$.

For a solution $v_{1}, v_{2}, \cdots, v_{n}$ for $\phi$. Let the corresponding $x_{1} = v_{1},\cdots, x_{n} = v_{n}$. Since the clauses in $\phi'$ is consisted of $m$ clause string like Eq. \eqref{EqSAT1}. Then for any clause string $j$ (for which $1
\leq j \leq m$), we assigned $y$ from left to right. For a clause $(\bar{y}_{i}\vee v_{i} \vee y_{i+1})$, if the first two variables are false, then assign $y_{i+1}$ to be true, otherwise assign $y_{i}$ to be false, since clause $(y_{i}\vee \bar{v}_{i} \vee F)$ and $({y}_{i}\vee \bar{y}_{i+1} \vee F)$ need to be satisfied. Obviously, in this assignments, the assignment of $y_{j}$ is fixed. Then we will get a satisfying assignment $x_{1},\cdots, x_{n}, y_{1},\cdots, y_{s}$ for $\phi'$.

For a solution $x_{1} = v_{1},\cdots, x_{n}= v_{n}, y_{1}=u_{1},\cdots, y_{s}= u_{s}$ for $\phi'$, we just need to let $x_{1} = v_{1},\cdots, x_{n}= v_{n}$ for $\phi$.

Since the mapping is monomorphism. Thus the number of solutions for $\phi$ and $\phi'$ is the same.
\end{itemize} 
\end{exercise}

    \begin{exercise}{2.14}
        If $M_1$ shows a polynomial-time Cook reduction from $L$ to $L'$ and $M_2$ shows a Cook reduction from $L'$ to $L''$,
        then consider $M_3$ which simulates $M_2$ and calls $M_1$ every time $M_2$ uses its oracle. Thus $M_3$ shows 
        $L$ is polynomial-time Cook reducible to $L''$, which indicates the transitivity.

        Construct a polynomial-time TM $M$. Assume $\phi$ is an instance of 3SAT. 
        $M$ runs TAUTOLOGY oracle on $\neg\phi$; if the output of the oracle is $b\in\bin$, $M$ outputs $b\oplus 1$.
        Thus 3SAT is Cook reducible to TAUTOLOGY.
    \end{exercise}
	
	
	\begin{exercise}{2.15}
		\begin{itemize}
			\item Note that the \textsf{CLIQUE} problem on the input $\langle G,k\rangle$ is equivalent to the \textsf{INDSET} problem on the input $\langle \bar G, k\rangle$. The complement graph of a given graph can be constructed in polynomial-times. I.e., \textsf{CLIQUE} and \textsf{INDSET} are polynomial-time reducible to one anther, which implies \textsf{CLIQUE} is \textbf{NP}-complete.

			\item Given a 3-CNF formula $\phi$ with $m$ clauses $C_1, \ldots, C_m$ on variable set $\{x_1,\ldots,x_n\}$, construc a graph $G = (V,E)$ where $V = \{v_{x_i}, v_{\overline{x_i}} \mid i \in [n]\} \cup \{v_{C_{i,1}}, v_{C_{i,2}}, v_{C_{i,3}} \mid i\in [m]\}$. Connect $v_{x_i}$ and $v_{\overline{x_i}}$ for all $i\in [n]$. Connect $v_{C_{i,1}}$, $v_{C_{i,2}}$ and $v_{C_{i,3}}$ pairwise for all $i \in [m]$. For $i \in [m]$ and $j \in [3]$, connect $v_{C_{i,j}}$ and $v_{x_k}$ if $j$-th literal in $C_i$ is $x_k$ and connect $v_{C_{i,j}}$ and $v_{\overline{x_k}}$ if it is $\overline{x_k}$. If $\phi$ is satisfiable with an assignment $y$, a $2m+n$-size vertex cover can be constructed. For all $i\in [n]$, $S$ gathers $v_{x_i}$ if $y_i$ is true, or gathers $v_{\overline{x_i}}$ otherwise. For each $i \in [m]$, $S$ gathers two of $v_{C_{i,1}}$, $v_{C_{i,2}}$ and $v_{C_{i,3}}$ with a vertex, which represents the satisfied literal in the assignment $y$ not gathered (such vertex must exist since each clause is satisfied). Clearly, $S$ covers all the edge in $G$. If there exists a vertex cover $S$ with size of $n+2m$, exact one vertex in $\{v_{x_i}, v_{\overline{x_i}}\}$ and exact two vertices in $\{v_{C_{j,1}}, v_{C_{j,2}}, v_{C_{j,3}}\}$ are gathered for all $i \in [n]$ and $j\in [m]$ due to the structure of $G$. Construct an assignment $y$ satisfying $\phi$. For all $i\in [n]$, if $v_{x_i}$ is gathered by $S$, set $y_i$ as true, or as false otherwise. Consider each $i\in [m]$, the not gathered vertex in $\{v_{C_{i,j}}\mid j\in [3]\}$ is incident to a edge which must be covered by anther vertex $v_{x_k}$ (or $v_{\overline{x_k}}$). $x_k$ (or $\overline{x_k}$) can satisfy $C_i$ and its value is true in $y$. Thus, $y$ satisfies $\phi$. Combining the fact that the construction of $G$ from $\phi$ can be done efficiently, \textsf{3SAT} can be reduced to \textsf{VERTEX COVER} polynomially, which means \textsf{VERTEX COVER} is \textbf{NP}-hard. Furthermore, it is easy to see the vertex covering can be checked within polynomial times. Thus, \textsf{VERTEX COVER} is \textbf{NP}-complete.		
		\end{itemize}
	\end{exercise}



	\begin{exercise}{2.20}
		To show that $REALQUADEQ$ is \textbf{NP}-complete, we make reduction from $3SAT$ to $REALQUADEQ$.
		Given a SAT instance, which has $n$ variables and $m$ clauses, we construct $REALQUADEQ$ which has $n+m$ variables and $n+m$ quadratic equations. For example, given
		\begin{align*}
			& x_1\vee x_2\vee x_3\\
			&\neg x_2\vee x_4\vee x_3\\
		\end{align*}
		for $m$ clause, we add $m$ new variables as $y_i$ and construct $m$ equation as 
		\begin{align*}
			&x_1^2+x_2^2+x^3-y_1^2=1\\
			&(1-x_2)^2+x_4^2+x_3^2-y_2^2=1\\
		\end{align*}
		To constrain orignal $x_i$ to have value in $\{0,1\}$, we construct extra $n$ equations as 
		$$x_i(1-x_i)=0$$.
	\end{exercise}
        
	\begin{exercise}{2.24}
	Since $\bar{L} \in NP$, then by the definition of NP, exists $p: \mathbb{N}\rightarrow \mathbb{N}$ and a polynomial TM $M$ s.t. for every $x \in \{0,1\}^{*}$,
$$x \in \bar{L} \Leftrightarrow \exists u \in \{0,1\}^{p(|x|)} \text{ s.t. } M(x,u) = 1$$
which means
$$x \in L \Leftrightarrow \forall u \in \{0,1\}^{p(|x|)} \text{ s.t. } M(x,u) = 0$$
Let $M'$ output $1$ if $M$ output $0$, and output $0$ if $M$ output $1$.
Then $M'$ satisfies
$$x \in L \Leftrightarrow \forall u \in \{0,1\}^{p(|x|)} \text{ s.t. } M'(x,u) = 1$$
That's implies definition 2.20.
\end{exercise}

    \begin{exercise}{2.25}
        For any $L\in NP=P$, $\overline{L}\in P=NP$, which means $L\in coNP$.
        For any $L\in coNP$, $\overline{L}\in NP=P$ and $L=\overline{\overline{L}}\in P=NP$, which means $L\in NP$.
        Therefore $NP=coNP$.
    \end{exercise}
	
	\begin{exercise}{2.26}
		Suppose $\textsf{3SAT} \leq_p \textsf{TAUTOLOGY}$ and $ \leq_p \textsf{TAUTOLOGY} \leq_p \textsf{3SAT}$. For any $L \in \textbf{NP}$, that $L \leq_q \in \textsf{3SAT}$ implies $\bar L \leq_q \in \overline{\textsf{3SAT}}$. Thus, we have $\bar L \leq_q \in \overline{\textsf{3SAT}} \leq_p \textsf{TAUTOLOGY} \leq_p \textsf{3SAT}$, which means $L \in \textbf{coNP}$. Besides, for any $L \in \textbf{coNP}$, $L \leq_p \textsf{TAUTOLOGY} \leq_p \textsf{3SAT}$. Combining them, $\textbf{NP} = \textbf{coNP}$ can be shown.

		Note that $\textsf{3SAT}$ is \textbf{NP}-complete and $\textsf{TAUTOLOGY}$ i s \textbf{coNP}-complete. If $\textbf{NP} = \textbf{coNP}$, they will be polynomial-time reducible to one another.
	\end{exercise}

\end{document}
